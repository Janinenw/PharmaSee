<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="/css/style.css">
	<title>Pharmacy List</title>
</head>
<body>
	<h1 id="pharmasee-header">Welcome to Pharmasee</h1>
	<h2 id="pharmasee-purpose">Purpose of Pharmasee: find which pharmacies near you have Adderall in stock.</h2>
	<div class="pharmacy-list">
		<ul>
		  <li>Look through pharmacies organized by town</li>
		  <li>See Adderall stock status</li>
		  <li>Click on a pharmacy to see its address and phone number</li>
		  <li>Add a pharmacy to the list</li>
		  <li>Update a pharmacy's stock status</li>
		</ul>
	  </div>
	<h3>Pharmacy List</h2>
	<div class="scrollable">
		<ul>
			<% pharmacys.forEach(function(pharmacy) { %>
				<li>
					<a href="/pharmacy/<%= pharmacy._id %>"><%= pharmacy.name %></a>
					<% if (pharmacy.dateUpdated) { %>
						<span>Updated on <%= pharmacy.dateUpdated %></span>
					<% } %>
					<% if (pharmacy.town) { %>
						<span>Town: <%= pharmacy.town %></span>
					<% } %>
					<% if (pharmacy.inStock) { %>
						<span>In Stock</span>
					<% } else { %>
						<span>Out of Stock</span>
					<% } %>
				
					<form action="/pharmacy/<%= pharmacy._id %>/edit" method="GET" style="display:inline">
						<button type="submit">Edit</button>
					</form>
					<form action="/pharmacy/<%= pharmacy._id %>?_method=DELETE" method="POST" style="display:inline" onsubmit="return checkDelete()">
						<button type="submit">Delete</button>
					</form>
				</li>
			<% }); %>
		</ul>
	</div>

	<a href="/pharmacy/new">Create New Pharmacy</a> 

	<script>
		const deletePrompt = () => {
			const confirmDelete = prompt("To delete this pharmacy, type 'delete' below: p.s. if you accidentally delete this, don't panic. you can click 'create new pharmacy' and fill out the form");
			if (confirmDelete === "delete") {
				return true;
			} else {
				return false;
			}
		}
		const checkDelete = () => {
			const confirmDelete = deletePrompt();
			if (confirmDelete) {
				return confirm("Are you sure you want to delete this pharmacy?");
			} else {
				return false;
			}
		}
	</script>
</body>
</html>
	