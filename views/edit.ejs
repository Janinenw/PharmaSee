<!DOCTYPE html>
<html>
<head>
	<title>Edit Pharmacy</title>
</head>
<body>
	<h1>Edit Pharmacy</h1>
	<form action="/pharmacy/<%= pharmacy._id %>?_method=PUT" method="POST" onsubmit="return checkForm()">
		<label for="name">Name:</label>
		<input type="text" id="name" name="name" value="<%= pharmacy.name %>"><br><br>
		<label for="address">Address:</label>
		<input type="text" id="address" name="address" value="<%= pharmacy.address %>"><br><br>
		<label for="town">Town:</label>
		<input type="text" id="town" name="town" value="<%= pharmacy.town %>"><br><br>
		<label for="phoneNumber">Phone Number:</label>
		<input type="text" id="phoneNumber" name="phoneNumber" value="<%= pharmacy.phoneNumber %>"><br><br>
		<label for="inStock">In Stock:</label>
		<input type="checkbox" id="inStock" name="inStock" <% if(pharmacy.inStock) { %> checked <% } %>><br><br>
		<label for="dateUpdatedMonth">Date Updated:</label>
		<input type="text" id="dateUpdatedMonth" name="dateUpdatedMonth" placeholder="MM" value="<%= pharmacy.dateUpdatedMonth %>"> /
		<input type="text" id="dateUpdatedDay" name="dateUpdatedDay" placeholder="DD" value="<%= pharmacy.dateUpdatedDay %>"> /
		<input type="text" id="dateUpdatedYear" name="dateUpdatedYear" placeholder="YYYY" value="<%= pharmacy.dateUpdatedYear %>">
		<button type="button" onclick="fillInDate()">Use Current Date</button><br><br>
		<button type="submit">Update</button>
	</form>
	<a href="/pharmacy/<%= pharmacy._id %>">Back to Pharmacy List</a>

	<script>
		const fillInDate = () => {
			const now = new Date();
			const year = now.getFullYear();
			const month = String(now.getMonth() + 1).padStart(2, '0');
			const day = String(now.getDate()).padStart(2, '0');
			document.getElementById('dateUpdatedMonth').value = month;
			document.getElementById('dateUpdatedDay').value = day;
			document.getElementById('dateUpdatedYear').value = year;
		}
		
		const checkForm = () => {
			const name = document.getElementById('name').value.trim();
			const address = document.getElementById('address').value.trim();
			const town = document.getElementById('town').value.trim();
			const phoneNumber = document.getElementById('phoneNumber').value.trim();
			const dateUpdatedMonth = document.getElementById('dateUpdatedMonth').value.trim();
			const dateUpdatedDay = document.getElementById('dateUpdatedDay').value.trim();
			const dateUpdatedYear = document.getElementById('dateUpdatedYear').value.trim();
			
			if (name === '' || address === '' || town === '' || phoneNumber === '' || dateUpdatedMonth === '' || dateUpdatedDay === '' || dateUpdatedYear === '') {
				return confirm('Please make sure all fields are filled out before updating. If you do not have the necessary information, you can write "N/A"  Press the okay button to continue');
			}
			return true;
		}
	</script>
</body>
</html>